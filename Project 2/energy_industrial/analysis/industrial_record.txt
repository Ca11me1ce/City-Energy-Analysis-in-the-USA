Mean/median/std before LOF
         elec_score     gas_score  num_establishments  elec_1kdollars      elec_mwh  gas_1kdollars       gas_mcf   elec_lb_ghg    gas_lb_ghg
count  8.838000e+03  8.838000e+03         8838.000000     8838.000000  8.838000e+03    8838.000000  8.838000e+03  8.838000e+03  8.838000e+03
mean   1.447604e+05  9.910556e+05          149.261739     4352.988798  6.057753e+04    2297.871747  4.730803e+05  9.113894e+07  5.678984e+07
std    2.575910e+06  1.660021e+07          650.402945    16844.349746  2.266995e+05    9312.090219  2.388090e+06  3.448248e+08  2.866727e+08
min    4.110728e+01  1.088806e+02            1.000000        0.000000  2.000000e+00       0.000000  0.000000e+00  1.810000e+03  0.000000e+00
25%    1.368196e+03  6.472973e+03           24.000000      176.000000  2.409750e+03      78.000000  1.352125e+04  3.442466e+06  1.623108e+06
50%    7.649316e+03  3.996932e+04           50.000000      678.000000  9.253000e+03     327.500000  5.798450e+04  1.349629e+07  6.960624e+06
75%    4.621141e+04  2.966537e+05          116.000000     2723.750000  3.626200e+04    1289.250000  2.432154e+05  5.406356e+07  2.919621e+07
max    1.606022e+08  1.021618e+09        26376.000000   606163.500000  9.948073e+06  383514.000000  1.447221e+08  1.332048e+10  1.737283e+10

LOF Algorithm:
k=100 : 73 outliers
k=200 : 80 outliers
k=500 : 195 outliers

Outlier Indexes: [8574, 4655, 4070, 83, 6482, 10, 5910, 5406, 4082, 7808, 7809, 8790, 8791, 1965, 8206, 496, 5431, 340, 2317, 2318, 2657, 169, 6319, 6317, 4761, 743, 744, 3244, 3243, 4932, 1981, 1114, 1928, 3287, 3420, 1922, 414, 2742, 7885, 1136, 5000, 1987, 3004, 8210, 6045, 7750, 3367, 7150, 2705, 6112, 6113, 6859, 4841, 4838, 4842, 6122, 1963, 2356, 7454, 3712, 4610, 449, 6010, 3717, 2169, 6851, 4581, 4452, 5756, 5587, 622, 5857, 3571, 1861, 3872, 5728, 8211, 1422, 1421, 3617]

Mean/median/std after LOF
         elec_score     gas_score  num_establishments  elec_1kdollars      elec_mwh  gas_1kdollars       gas_mcf   elec_lb_ghg    gas_lb_ghg
count  8.758000e+03  8.758000e+03         8758.000000     8758.000000  8.758000e+03    8758.000000  8.758000e+03  8.758000e+03  8.758000e+03
mean   7.829604e+04  5.433837e+05          126.475308     3457.710607  4.803282e+04    1796.466573  3.493082e+05  7.158760e+07  4.193189e+07
std    3.641843e+05  2.617764e+06          385.916171     8734.662263  1.251191e+05    5001.022166  1.008988e+06  1.875375e+08  1.211217e+08
min    4.110728e+01  1.088806e+02            1.000000        0.000000  2.000000e+00       0.000000  9.000000e+00  1.810000e+03  1.109000e+03
25%    1.335276e+03  6.472973e+03           24.000000      176.000000  2.408000e+03      78.000000  1.350450e+04  3.440852e+06  1.621157e+06
50%    7.435592e+03  3.883784e+04           49.000000      672.000000  9.062000e+03     322.500000  5.712500e+04  1.338700e+07  6.857438e+06
75%    4.400513e+04  2.852238e+05          115.000000     2655.500000  3.525475e+04    1257.750000  2.371442e+05  5.229498e+07  2.846748e+07
max    1.126464e+07  8.849199e+07        26376.000000   116949.000000  1.714177e+06  101204.000000  1.490491e+07  2.202774e+09  1.789225e+09


Equal-width binning: 

attr: elec_score


Bins are: 
 [1 1 1 ... 1 1 1]

Bin count is : [   0 8680   51   11    4    1    4    1    2    2    2]

After bin_group is added we have:
         city state_abbr     elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars    gas_mcf  elec_lb_ghg   gas_lb_ghg  bin_group
0   Abbeville         LA    1032.383773  7.298636e+03                67.0           501.0    9861.0          896.0   288103.0   15734217.0   34584628.0          1
1  Abbotsford         WI     675.797246  3.302651e+03                25.0          3151.0   42034.0         1265.0   250434.0   45496597.0   30062736.0          1
2    Aberdeen         MD    1626.990710  5.936807e+03                35.0           781.0    9913.0          352.0    39952.0   19103260.0    4795947.0          1
3    Aberdeen         MS    4694.645706  4.076750e+04                45.0          3841.0   66291.0         2084.0   479031.0  111124788.0   57504200.0          1
4    Aberdeen         NJ   35632.945911  1.274283e+05                48.0           352.0    3467.0          191.0    28953.0    6680699.0    3475582.0          1
5    Aberdeen         SD   25050.715106  2.604314e+05               148.0          1759.0   23230.0         1759.0   368069.0   25143707.0   44183961.0          1
6    Aberdeen         WA    5276.162522  1.992691e+04                69.0           247.0    5574.0          129.0    17208.0    6875006.0    2065725.0          1
7   Abernathy         TX     542.330237  1.978936e+03                73.0           859.0   16127.0          622.0   234605.0   34218263.0   28162605.0          1
8     Abilene         KS     863.434462  6.472973e+03                52.0          2602.0   34733.0         1391.0   377080.0   62548693.0   45265754.0          1
9     Abilene         TX  157413.389213  1.183603e+06              1066.0          5222.0   98015.0         3779.0  1425895.0  131241875.0  171168225.0          1

Bin Counts
(40.107, 1126499.842]           8680
(1126499.842, 2252959.576]        51
(2252959.576, 3379419.311]        11
(5632338.779, 6758798.514]         4
(3379419.311, 4505879.045]         4
(10138177.717, 11264637.452]       2
(9011717.983, 10138177.717]        2
(7885258.248, 9011717.983]         2
(6758798.514, 7885258.248]         1
(4505879.045, 5632338.779]         1
Name: bin_ranges, dtype: int64

attr: gas_score


Bins are: 
 [1 1 1 ... 1 1 1]

Bin count is : [   0 8691   44    9    1    6    1    1    2    1    2]

After bin_group is added we have:
         city state_abbr     elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars    gas_mcf  elec_lb_ghg   gas_lb_ghg  bin_group
0   Abbeville         LA    1032.383773  7.298636e+03                67.0           501.0    9861.0          896.0   288103.0   15734217.0   34584628.0          1
1  Abbotsford         WI     675.797246  3.302651e+03                25.0          3151.0   42034.0         1265.0   250434.0   45496597.0   30062736.0          1
2    Aberdeen         MD    1626.990710  5.936807e+03                35.0           781.0    9913.0          352.0    39952.0   19103260.0    4795947.0          1
3    Aberdeen         MS    4694.645706  4.076750e+04                45.0          3841.0   66291.0         2084.0   479031.0  111124788.0   57504200.0          1
4    Aberdeen         NJ   35632.945911  1.274283e+05                48.0           352.0    3467.0          191.0    28953.0    6680699.0    3475582.0          1
5    Aberdeen         SD   25050.715106  2.604314e+05               148.0          1759.0   23230.0         1759.0   368069.0   25143707.0   44183961.0          1
6    Aberdeen         WA    5276.162522  1.992691e+04                69.0           247.0    5574.0          129.0    17208.0    6875006.0    2065725.0          1
7   Abernathy         TX     542.330237  1.978936e+03                73.0           859.0   16127.0          622.0   234605.0   34218263.0   28162605.0          1
8     Abilene         KS     863.434462  6.472973e+03                52.0          2602.0   34733.0         1391.0   377080.0   62548693.0   45265754.0          1
9     Abilene         TX  157413.389213  1.183603e+06              1066.0          5222.0   98015.0         3779.0  1425895.0  131241875.0  171168225.0          1

Bin Counts
(107.881, 8849296.317]          8691
(8849296.317, 17698484.754]       44
(17698484.754, 26547673.191]       9
(35396861.628, 44246050.065]       6
(79642803.813, 88491992.249]       2
(61944426.939, 70793615.376]       2
(70793615.376, 79642803.813]       1
(53095238.502, 61944426.939]       1
(44246050.065, 53095238.502]       1
(26547673.191, 35396861.628]       1
Name: bin_ranges, dtype: int64

Equal-depth binning: 

attr: elec_score

 New column of data: 
         city state_abbr     elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars    gas_mcf  elec_lb_ghg   gas_lb_ghg elec_bin_group
0   Abbeville         LA    1032.383773  7.298636e+03                67.0           501.0    9861.0          896.0   288103.0   15734217.0   34584628.0              2
1  Abbotsford         WI     675.797246  3.302651e+03                25.0          3151.0   42034.0         1265.0   250434.0   45496597.0   30062736.0              3
2    Aberdeen         MD    1626.990710  5.936807e+03                35.0           781.0    9913.0          352.0    39952.0   19103260.0    4795947.0              2
3    Aberdeen         MS    4694.645706  4.076750e+04                45.0          3841.0   66291.0         2084.0   479031.0  111124788.0   57504200.0              3
4    Aberdeen         NJ   35632.945911  1.274283e+05                48.0           352.0    3467.0          191.0    28953.0    6680699.0    3475582.0              1
5    Aberdeen         SD   25050.715106  2.604314e+05               148.0          1759.0   23230.0         1759.0   368069.0   25143707.0   44183961.0              3
6    Aberdeen         WA    5276.162522  1.992691e+04                69.0           247.0    5574.0          129.0    17208.0    6875006.0    2065725.0              2
7   Abernathy         TX     542.330237  1.978936e+03                73.0           859.0   16127.0          622.0   234605.0   34218263.0   28162605.0              2
8     Abilene         KS     863.434462  6.472973e+03                52.0          2602.0   34733.0         1391.0   377080.0   62548693.0   45265754.0              3
9     Abilene         TX  157413.389213  1.183603e+06              1066.0          5222.0   98015.0         3779.0  1425895.0  131241875.0  171168225.0              3

Bin Counts
2    2943
1    2931
3    2884
Name: elec_bin_group, dtype: int64

 New column of data: 
         city state_abbr     elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars    gas_mcf  elec_lb_ghg   gas_lb_ghg elec_bin_group gas_bin_group
0   Abbeville         LA    1032.383773  7.298636e+03                67.0           501.0    9861.0          896.0   288103.0   15734217.0   34584628.0              2             3
1  Abbotsford         WI     675.797246  3.302651e+03                25.0          3151.0   42034.0         1265.0   250434.0   45496597.0   30062736.0              3             3
2    Aberdeen         MD    1626.990710  5.936807e+03                35.0           781.0    9913.0          352.0    39952.0   19103260.0    4795947.0              2             2
3    Aberdeen         MS    4694.645706  4.076750e+04                45.0          3841.0   66291.0         2084.0   479031.0  111124788.0   57504200.0              3             3
4    Aberdeen         NJ   35632.945911  1.274283e+05                48.0           352.0    3467.0          191.0    28953.0    6680699.0    3475582.0              1             2
5    Aberdeen         SD   25050.715106  2.604314e+05               148.0          1759.0   23230.0         1759.0   368069.0   25143707.0   44183961.0              3             3
6    Aberdeen         WA    5276.162522  1.992691e+04                69.0           247.0    5574.0          129.0    17208.0    6875006.0    2065725.0              2             1
7   Abernathy         TX     542.330237  1.978936e+03                73.0           859.0   16127.0          622.0   234605.0   34218263.0   28162605.0              2             3
8     Abilene         KS     863.434462  6.472973e+03                52.0          2602.0   34733.0         1391.0   377080.0   62548693.0   45265754.0              3             3
9     Abilene         TX  157413.389213  1.183603e+06              1066.0          5222.0   98015.0         3779.0  1425895.0  131241875.0  171168225.0              3             3

Bin Counts
2    2945
1    2927
3    2886
Name: gas_bin_group, dtype: int64
