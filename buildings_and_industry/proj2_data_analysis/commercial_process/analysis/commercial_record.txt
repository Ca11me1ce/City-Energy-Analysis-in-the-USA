Mean/median/std before LOF
         elec_score     gas_score  num_establishments  elec_1kdollars      elec_mwh  gas_1kdollars       gas_mcf   elec_lb_ghg    gas_lb_ghg
count  1.681700e+04  1.681700e+04        16817.000000    1.681700e+04  1.681700e+04   16817.000000  1.681700e+04  1.681700e+04  1.681700e+04
mean   2.815463e+05  4.965164e+05          213.497324    5.028705e+03  4.375860e+04     921.295088  1.279799e+05  6.551241e+07  1.536305e+07
std    1.060614e+07  1.749169e+07         1382.856060    5.399270e+04  3.673301e+05    8260.490014  1.270724e+06  5.536591e+08  1.525411e+08
min    2.637443e+01  5.415054e+01            0.000000    0.000000e+00  0.000000e+00       0.000000  0.000000e+00  0.000000e+00  0.000000e+00
25%    1.101228e+03  1.705785e+03           12.000000    1.110000e+02  1.148000e+03       4.000000  5.490000e+02  1.588394e+06  6.591900e+04
50%    6.221925e+03  1.016881e+04           42.000000    4.170000e+02  4.199000e+03      47.000000  7.021000e+03  6.139039e+06  8.427860e+05
75%    3.657742e+04  6.914905e+04          145.000000    2.091000e+03  2.021600e+04     346.000000  4.946800e+04  3.022526e+07  5.938224e+06
max    1.184669e+09  1.913918e+09        92276.000000    4.291287e+06  2.602481e+07  564887.000000  9.751826e+07  3.899552e+10  1.170635e+10

LOF Algorithm:
k=100 : 82 outliers
k=200 : 188 outliers
k=500 : 296 outliers

Outlier Indexes: [11319, 10974, 748, 16729, 7394, 6004, 3840, 3888, 16269, 3695, 12515, 3798, 13929, 15068, 14009, 16109, 15373, 6312, 13871, 14743, 16796, 10549, 14018, 7879, 2912, 16363, 12749, 16757, 14663, 2397, 5611, 7274, 290, 12756, 15464, 15916, 6911, 8856, 5223, 7250, 175, 164, 1084, 9734, 10548, 10546, 2360, 4602, 16634, 3306, 5046, 16696, 505, 8083, 1780, 11911, 14947, 3633, 6870, 7765, 9297, 6896, 7486, 11316, 7777, 12067, 10905, 4654, 101, 7764, 10771, 7867, 9491, 12595, 4951, 7397, 7398, 2623, 4636, 12428, 16362, 9559, 9502, 13355, 13645, 11362, 1808, 14204, 16053, 13164, 12711, 8709, 11654, 6637, 7174, 5913, 9738, 16149, 8643, 8644, 14523, 10438, 8459, 4539, 11131, 11133, 8366, 11858, 15528, 6448, 5857, 9126, 12109, 12107, 3034, 11690, 10803, 2439, 4462, 4461, 99, 15729, 11400, 11796, 11799, 7561, 14319, 14218, 16308, 141, 883, 12234, 5309, 16312, 9707, 2784, 2783, 4300, 14090, 13154, 1539, 3448, 2011, 9954, 11653, 2734, 7490, 8320, 343, 5224, 7909, 11483, 11605, 13389, 9407, 9409, 9411, 6885, 6611, 11735, 11737, 14213, 13728, 15081, 492, 491, 3570, 3155, 10490, 13159, 704, 7513, 11078, 3862, 13146, 11755, 802, 3587, 15703, 15718, 15709, 2719, 2718, 7476, 6972, 8616, 10541, 10542]

Mean/median/std after LOF
         elec_score     gas_score  num_establishments  elec_1kdollars      elec_mwh  gas_1kdollars       gas_mcf   elec_lb_ghg    gas_lb_ghg
count  1.662900e+04  1.662900e+04        16629.000000    16629.000000  1.662900e+04   16629.000000  1.662900e+04  1.662900e+04  1.662900e+04
mean   8.716844e+04  1.606009e+05          150.941683     2931.775092  2.672935e+04     521.123715  7.295454e+04  3.956725e+07  8.757659e+06
std    3.423838e+05  6.314658e+05          328.013776     7880.850685  6.858559e+04    1554.496025  2.185180e+05  1.000715e+08  2.623149e+07
min    2.637443e+01  5.415054e+01            0.000000        0.000000  0.000000e+00       0.000000  0.000000e+00  0.000000e+00  0.000000e+00
25%    1.086931e+03  1.686127e+03           12.000000      111.000000  1.134000e+03       3.000000  5.210000e+02  1.575912e+06  6.260100e+04
50%    6.096895e+03  9.959380e+03           42.000000      410.000000  4.127000e+03      45.000000  6.713000e+03  6.019983e+06  8.058330e+05
75%    3.543686e+04  6.700570e+04          141.000000     1996.000000  1.937600e+04     326.000000  4.646100e+04  2.907200e+07  5.577356e+06
max    1.097782e+07  2.054393e+07         6132.000000   177472.000000  1.181388e+06   29934.500000  4.368492e+06  1.296378e+09  5.244055e+08


Equal-width binning: 

attr: elec_score


Bins are: 
 [1 1 1 ... 1 1 1]

Bin count is : [    0 16386   159    50    21     6     1     1     2     1     2]

After bin_group is added we have:
          city state_abbr    elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars  gas_mcf  elec_lb_ghg  gas_lb_ghg  bin_group
0    Abbeville         LA  22738.738371  36118.036596               315.0          3668.0   35874.0          585.0  73920.0   57242436.0   8873594.0          1
1        Abbot         ME   2288.799802   4329.585529                 5.0            23.0     190.0            0.0      0.0     206707.0         0.0          1
2   Abbotsford         WI  18603.702963  26444.405273                61.0           592.0    5968.0          108.0  16440.0    6460008.0   1973481.0          1
3       Abbott         PA    297.680770    651.638925                 6.0            25.0     274.0            5.0    683.0     527464.0     81991.0          1
4       Abbott         TX    531.182058    928.267336                 1.0             7.0      85.0            1.0    116.0     113766.0     13929.0          1
5  Abbottstown         PA    550.323771    766.713415                19.0            83.0     861.0           86.0  10969.0    1659700.0   1316795.0          1
6    Abbyville         KS    255.819516    225.963190                 2.0            27.0     265.0            3.0    466.0     477452.0     55927.0          1
7  Abercrombie         MN    249.071722    672.245875                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0          1
8  Abercrombie         ND    498.143444   1344.491750                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0          1
9     Aberdeen         ID   2879.328782   3731.124617                47.0           245.0    3164.0          146.0  20693.0    3902778.0   2484084.0          1

Bin Counts
(25.374, 1097805.201]          16386
(1097805.201, 2195585.027]       159
(2195585.027, 3293364.853]        50
(3293364.853, 4391144.68]         21
(4391144.68, 5488924.506]          6
(9880043.812, 10977823.638]        2
(7684484.159, 8782263.985]         2
(8782263.985, 9880043.812]         1
(6586704.333, 7684484.159]         1
(5488924.506, 6586704.333]         1
Name: bin_ranges, dtype: int64

attr: gas_score


Bins are: 
 [1 1 1 ... 1 1 1]

Bin count is : [    0 16388   162    47    21     4     1     2     1     1     2]

After bin_group is added we have:
          city state_abbr    elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars  gas_mcf  elec_lb_ghg  gas_lb_ghg  bin_group
0    Abbeville         LA  22738.738371  36118.036596               315.0          3668.0   35874.0          585.0  73920.0   57242436.0   8873594.0          1
1        Abbot         ME   2288.799802   4329.585529                 5.0            23.0     190.0            0.0      0.0     206707.0         0.0          1
2   Abbotsford         WI  18603.702963  26444.405273                61.0           592.0    5968.0          108.0  16440.0    6460008.0   1973481.0          1
3       Abbott         PA    297.680770    651.638925                 6.0            25.0     274.0            5.0    683.0     527464.0     81991.0          1
4       Abbott         TX    531.182058    928.267336                 1.0             7.0      85.0            1.0    116.0     113766.0     13929.0          1
5  Abbottstown         PA    550.323771    766.713415                19.0            83.0     861.0           86.0  10969.0    1659700.0   1316795.0          1
6    Abbyville         KS    255.819516    225.963190                 2.0            27.0     265.0            3.0    466.0     477452.0     55927.0          1
7  Abercrombie         MN    249.071722    672.245875                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0          1
8  Abercrombie         ND    498.143444   1344.491750                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0          1
9     Aberdeen         ID   2879.328782   3731.124617                47.0           245.0    3164.0          146.0  20693.0    3902778.0   2484084.0          1

Bin Counts
(53.151, 2054440.66]            16388
(2054440.66, 4108828.17]          162
(4108828.17, 6163215.679]          47
(6163215.679, 8217603.189]         21
(8217603.189, 10271990.699]         4
(18489540.737, 20543928.247]        2
(12326378.208, 14380765.718]        2
(16435153.227, 18489540.737]        1
(14380765.718, 16435153.227]        1
(10271990.699, 12326378.208]        1
Name: bin_ranges, dtype: int64

Equal-depth binning: 

attr: elec_score

 New column of data: 
          city state_abbr    elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars  gas_mcf  elec_lb_ghg  gas_lb_ghg elec_bin_group
0    Abbeville         LA  22738.738371  36118.036596               315.0          3668.0   35874.0          585.0  73920.0   57242436.0   8873594.0              3
1        Abbot         ME   2288.799802   4329.585529                 5.0            23.0     190.0            0.0      0.0     206707.0         0.0              1
2   Abbotsford         WI  18603.702963  26444.405273                61.0           592.0    5968.0          108.0  16440.0    6460008.0   1973481.0              2
3       Abbott         PA    297.680770    651.638925                 6.0            25.0     274.0            5.0    683.0     527464.0     81991.0              1
4       Abbott         TX    531.182058    928.267336                 1.0             7.0      85.0            1.0    116.0     113766.0     13929.0              1
5  Abbottstown         PA    550.323771    766.713415                19.0            83.0     861.0           86.0  10969.0    1659700.0   1316795.0              1
6    Abbyville         KS    255.819516    225.963190                 2.0            27.0     265.0            3.0    466.0     477452.0     55927.0              1
7  Abercrombie         MN    249.071722    672.245875                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0              1
8  Abercrombie         ND    498.143444   1344.491750                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0              1
9     Aberdeen         ID   2879.328782   3731.124617                47.0           245.0    3164.0          146.0  20693.0    3902778.0   2484084.0              2

Bin Counts
1    5544
2    5543
3    5542
Name: elec_bin_group, dtype: int64

 New column of data: 
          city state_abbr    elec_score     gas_score  num_establishments  elec_1kdollars  elec_mwh  gas_1kdollars  gas_mcf  elec_lb_ghg  gas_lb_ghg elec_bin_group gas_bin_group
0    Abbeville         LA  22738.738371  36118.036596               315.0          3668.0   35874.0          585.0  73920.0   57242436.0   8873594.0              3             3
1        Abbot         ME   2288.799802   4329.585529                 5.0            23.0     190.0            0.0      0.0     206707.0         0.0              1             1
2   Abbotsford         WI  18603.702963  26444.405273                61.0           592.0    5968.0          108.0  16440.0    6460008.0   1973481.0              2             2
3       Abbott         PA    297.680770    651.638925                 6.0            25.0     274.0            5.0    683.0     527464.0     81991.0              1             1
4       Abbott         TX    531.182058    928.267336                 1.0             7.0      85.0            1.0    116.0     113766.0     13929.0              1             1
5  Abbottstown         PA    550.323771    766.713415                19.0            83.0     861.0           86.0  10969.0    1659700.0   1316795.0              1             2
6    Abbyville         KS    255.819516    225.963190                 2.0            27.0     265.0            3.0    466.0     477452.0     55927.0              1             1
7  Abercrombie         MN    249.071722    672.245875                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0              1             1
8  Abercrombie         ND    498.143444   1344.491750                16.0           127.0    1307.0            0.0      9.0    1414897.0      1081.0              1             1
9     Aberdeen         ID   2879.328782   3731.124617                47.0           245.0    3164.0          146.0  20693.0    3902778.0   2484084.0              2             2

Bin Counts
1    5545
2    5543
3    5541
Name: gas_bin_group, dtype: int64
